<!DOCTYPE html>
<html>
<head>
  <!--
    If you are serving your web app in a path other than the root, change the
    href value below to reflect the base path you are serving from.

    The path provided below has to start and end with a slash "/" in order for
    it to work correctly.

    For more details:
    * https://developer.mozilla.org/en-US/docs/Web/HTML/Element/base

    This is a placeholder for base href that will be replaced by the value of
    the `--base-href` argument provided to `flutter build`.
  -->
  <base href="$FLUTTER_BASE_HREF">

  <meta charset="UTF-8">
  <meta content="IE=Edge" http-equiv="X-UA-Compatible">
  <meta name="description" content="가족과 함께하는 일상 관리 플래너 - 일정, 할일, 자산, 가계부를 한 곳에서">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover, interactive-widget=overlays-content">

  <!-- Google Sign-In Configuration -->
  <!-- TODO: Google Cloud Console에서 OAuth 2.0 클라이언트 ID를 발급받아 아래 YOUR_GOOGLE_WEB_CLIENT_ID를 교체하세요 -->
  <!-- 발급 방법: https://console.cloud.google.com/apis/credentials -->
  <!-- 승인된 JavaScript 원본: http://localhost:3001, https://yourdomain.com -->
  <!-- 승인된 리디렉션 URI: http://localhost:3001, https://yourdomain.com -->

  <meta name="google-signin-client_id" content="1091403716522-pgm7m06s5tcpen6g0okcpvd8djfq0m5l.apps.googleusercontent.com">

  <!-- iOS meta tags & icons -->
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="Family Planner">
  <link rel="apple-touch-icon" href="icons/Icon-192.png">

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="favicon.png"/>

  <title>Family Planner - 가족 플래너</title>
  <link rel="manifest" href="manifest.json">

  <style>
    html {
      height: 100%;
      width: 100%;
      overflow: hidden; /* 스크롤 방지 */
    }

    body {
      /* height: 100% 대신 position: fixed를 사용하여 화면 꽉 채우기 고정 */
      position: fixed; 
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      width: 100%;
      height: 100%; /* fixed 상태에서의 100%는 뷰포트 전체를 의미 */
      
      overflow: hidden;
      margin: 0;
      padding: 0;
      
      /* iOS 터치 딜레이 및 스크롤 바운스 방지 */
      touch-action: none;
      -ms-touch-action: none;
      -webkit-user-select: none;
      user-select: none;
      -webkit-tap-highlight-color: transparent;
    }

    /* Flutter 내부 뷰포트 보정 */
    flt-glass-pane {
      position: absolute !important;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      height: 100% !important;
    }

    /* iOS 폰트 크기 자동 조절 방지 */
    input, textarea {
      font-size: 16px !important; 
    }
  </style>
</head>
<body>
  <!-- Fix for RawKeyboard null safety issue in Flutter Web -->
  <script>
    (function() {
      // Patch KeyboardEvent prototype to ensure boolean properties are never null
      const originalRepeatGetter = Object.getOwnPropertyDescriptor(KeyboardEvent.prototype, 'repeat')?.get;
      const originalIsComposingGetter = Object.getOwnPropertyDescriptor(KeyboardEvent.prototype, 'isComposing')?.get;

      // Override repeat getter
      if (originalRepeatGetter) {
        Object.defineProperty(KeyboardEvent.prototype, 'repeat', {
          get: function() {
            const value = originalRepeatGetter.call(this);
            return value === null || value === undefined ? false : value;
          },
          configurable: true,
          enumerable: true
        });
      }

      // Override isComposing getter
      if (originalIsComposingGetter) {
        Object.defineProperty(KeyboardEvent.prototype, 'isComposing', {
          get: function() {
            const value = originalIsComposingGetter.call(this);
            return value === null || value === undefined ? false : value;
          },
          configurable: true,
          enumerable: true
        });
      }

      // Fallback: Also intercept events as they bubble
      const patchEvent = function(event) {
        if (event.repeat === null || event.repeat === undefined) {
          try {
            Object.defineProperty(event, 'repeat', {
              value: false,
              writable: true,
              configurable: true,
              enumerable: true
            });
          } catch (e) {
            // Ignore if property is not configurable
          }
        }
        if (event.isComposing === null || event.isComposing === undefined) {
          try {
            Object.defineProperty(event, 'isComposing', {
              value: false,
              writable: true,
              configurable: true,
              enumerable: true
            });
          } catch (e) {
            // Ignore if property is not configurable
          }
        }
      };

      window.addEventListener('keydown', patchEvent, true);
      window.addEventListener('keyup', patchEvent, true);
      window.addEventListener('keypress', patchEvent, true);
    })();
  </script>
  <script src="flutter_bootstrap.js" async></script>
</body>
</html>
